This is the eval-encoding branch of Halo.